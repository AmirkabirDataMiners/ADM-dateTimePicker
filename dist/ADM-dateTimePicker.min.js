!function(a){"use strict";String.prototype.toPersianDigits=function(){var a=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];return this.replace(/[0-9]/g,function(b){return a[+b]})},String.prototype.toEnglishDigits=function(){var a={"۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"};return this.replace(/[^0-9.]/g,function(b){return a[b]||b})},String.prototype.lZero=function(){return this.length<2?"0"+this:this},Array.prototype.toNumber=function(){return this.map(function(a){return Number(a)})},Number.prototype.lZero=function(){return this<10?"0"+this:this};var b=function(){var b={calType:"gregorian",format:"YYYY/MM/DD hh:mm",multiple:!0,autoClose:!1,transition:!0,disabled:[],smartDisabling:!0},c={getOptions:function(a){var c=a&&b[a]||b;return c}};this.setOptions=function(c,d){return d?void(b[c]=a.extend(b[c]||{},d)):(d=c,void(b=a.extend(b,d)))},this.$get=function(){return c}},c=function(){return function(a,b){return"jalali"==b?String(a).toPersianDigits():a}},d=function(){function a(a){var c=h(a);return c-=226894,b(c)}function b(a){var b=f(a),e=d(a,b),g=c(a,b,e),h={day:g,month:e,year:b};return h}function c(a,b,c){var d=g(b);a-=d+365*(b-1);for(var e=1;e<c;e++)a-=e<=6?31:30;return a}function d(a,b){var c=g(b);a-=c+365*(b-1);for(var d=e(),f=0;f<d.length;f++){if(a<=d[f].count)return d[f].id;a-=d[f].count}return 12}function e(){return[{id:1,count:31},{id:2,count:31},{id:3,count:31},{id:4,count:31},{id:5,count:31},{id:6,count:31},{id:7,count:30},{id:8,count:30},{id:9,count:30},{id:10,count:30},{id:11,count:30},{id:12,count:29}]}function f(a){var b=Math.floor((a-1)/365),c=0;if(b>22){var d=b-22-1,e=b-22,f=Math.floor(d/33),h=e-33*f;h>=28&&(h=28);var i=Math.floor(h/4),j=i+8*f+6,k=Math.floor((a-j)/365);return c=g(k),a-365*k-c-(t(k)?1:0)>0?(k++,k):a-365*k+c<=0?k:k}return c=b<1?0:b>=1&&b<=4?1:b>=5&&b<=8?2:b>=9&&b<=12?3:b>=13&&b<=16?4:b>=17&&b<22?5:6,b=Math.floor((a-c-1)/365),b+1}function g(a){if(a<23)switch(a){case 1:return 0;case 2:case 3:case 4:case 5:return 1;case 6:case 7:case 8:case 9:return 2;case 10:case 11:case 12:case 13:return 3;case 14:case 15:case 16:case 17:return 4;case 18:case 19:case 20:case 21:case 22:return 5}var b=a-22,c=Math.floor((b-1)/33),d=b-33*c;d>28&&(d=28);var e=Math.floor(d/4)+8*c+6;return t(a)&&b-33*c<=28&&e--,e}function h(a){var b=i(),c=k(a.year),d=c,e=j(a.year);d+=365*(a.year-1);for(var f=0;f<a.month-1;f++)e&&f+1==2&&(b[f].count=29),d+=b[f].count;return d+=a.day}function i(){return[{id:1,count:31},{id:2,count:28},{id:3,count:31},{id:4,count:30},{id:5,count:31},{id:6,count:30},{id:7,count:31},{id:8,count:31},{id:9,count:30},{id:10,count:31},{id:11,count:30},{id:12,count:31}]}function j(a){return a%4==0&&(a%100!=0||a%400==0)}function k(a){var b=a-1,c=Math.floor(b/4),d=Math.floor(b/100),e=Math.floor(b/400);return c-d+e}function l(a){var b=Math.floor(a/365),c=k(b),d=Math.floor((a-c)/365),e=a-365*d-c;return 0!=e?d++:j(d+1)&&(d+=c/365),Math.floor(d)}function m(a){var b=l(a),c=k(b-1);a-=365*(b-1)+c;for(var d=i(),e=0,f=j(b),g=0;g<d.length;g++){if(f&&2==d[g].id&&(d[g].count=29),a<d[g].count)return 0==a&&0!=e||e++,e;a-=d[g].count,e=d[g].id}return e}function n(a){var b=l(a),c=m(a);return o(b,c,a)}function o(a,b,c){for(var d=k(a-1),e=i(),f=0,g=0;g<e.length;g++)e[g].id<b&&(f+=e[g].count);return j(a)&&b>2&&f++,c-365*(a-1)-d-f}function p(a){var b=a.day;return b+=q(a.month),b+=r(a.year)}function q(a){for(var b=0,c=e(),d=0;d<a-1;d++)b+=c[d].count;return b}function r(a){var b=g(a);return b+=365*(a-1)}function s(a){var b=p(a)+226894,c=n(b),d=m(b),e=l(b);return{day:c,month:d,year:e}}var t=function(a){if(1==a||5==a||9==a||13==a||17==a||22==a)return!0;if(a<22)return!1;var b=a-22,c=Math.floor(b/33);return(b-33*c)%4==0&&(b-33*c)/4!=8},u=function(b,c,d){b=b<=99?2e3+b:b;var e={year:b,month:c,day:d};return e=a(e)},v=function(a,b,c){a=a<=99?1300+a:a;var d=s({day:c,month:b,year:a});return d};return{toJalali:u,toGregorian:v,isLeapJalali:t}},e=function(b){return this.dateFormat=function(a,b,c,d){for(var e=a.year,f=d?a.year:a.year%100,g=a.month.lZero(),h=a.day.lZero(),i=b.hour.lZero(),j=b.minute.lZero(),k=[{key:"YYYY",value:e},{key:"YY",value:f},{key:"MM",value:g},{key:"DD",value:h},{key:"hh",value:i},{key:"mm",value:j}],l=0,m=k.length;l<m;l++)c=c.replace(k[l].key,k[l].value);return c},this.parseString=function(a,b){var c=[],d={},e=["YY/MM/DD","YY/MM/DD hh:mm","YY-MM-DD","YY-MM-DD hh:mm","MM/DD/YY","MM-DD-YY","MM/DD/YY hh:mm","MM-DD-YY hh:mm"];e.unshift(b);for(var f=0,g=b.length;f<g;f++){var h=new RegExp(e[f].replace(/[a-z]+/gi,function(a){var b=!1;return a.indexOf("YY")!=-1?(c.push("year"),b=!0):a.indexOf("MM")!=-1?(c.push("month"),b=!0):a.indexOf("DD")!=-1?(c.push("day"),b=!0):a.indexOf("hh")!=-1?(c.push("hour"),b=!0):a.indexOf("mm")!=-1&&(c.push("minute"),b=!0),b?"[0-9]+":a}).replace(/[(]/g,"[(]").replace(/[)]/g,"[)]")).test(a);if(h)return c.reverse(),a.replace(/[0-9]+/g,function(a){return d[c.pop()]=Number(a),a}),d.hour=d.hour||0,d.minute=d.minute||0,d}return!1},this.toRegularFormat=function(a,b,c){return"string"==typeof a?a=this.parseString(a,c):"number"==typeof a&&(a=this.convertFromUnix(a,b)),a.year<=99&&(a.year="jalali"==b?1300+a.year:2e3+a.year),a.year+"/"+a.month.lZero()+"/"+a.day.lZero()+" "+a.hour.lZero()+":"+a.minute.lZero()},this.isDateEqual=function(a,b){var c=new Date(a)-new Date(b);return 0==c},this.isDateBigger=function(a,b){var c=new Date(a)-new Date(b);return c>=0},this.isMonthBigger=function(a,b){var c=new Date(a.year,a.month)-new Date(b.year,b.month);return c>=0},this.joinTime=function(a,b){return new Date(new Date(new Date(a).setHours(b.hour)).setMinutes(b.minute))},this.removeTime=function(a){return new Date(a.getFullYear(),a.getMonth(),a.getDate())},this.validateJalaliDateSeparate=function(a,c){if(3!=a.length||2!=c.length)return!1;if(c[0]>23||c[0]<0||c[1]>59||c[1]<0||a[0]<0||a[1]<1||a[1]>12)return!1;if(a[1]>0&&a[1]<7){if(a[2]<1||a[2]>31)return!1}else if(a[1]>6&&a[1]<12){if(a[2]<1||a[2]>30)return!1}else if(12==a[1]){var d=b.isLeapJalali(a[0]);if(d&&(a[2]<1||a[2]>30)||!d&&(a[2]<1||a[2]>29))return!1}return!0},this.validateJalaliDate=function(c,d){var e;if("number"==typeof c){var f=new Date(c);if("Invalid Date"==f)return!1;var g=this.convertToJalali(f);e=a.extend(g,{hour:f.getHours(),minute:f.getMinutes()})}else"string"==typeof c?e=this.parseString(c,d):c instanceof Object&&(e=c);var h=[e.year,e.month,e.day],i=[e.hour,e.minute];if(this.validateJalaliDateSeparate(h,i)){var j=b.toGregorian(h[0],h[1],h[2]),f=new Date(j.year,j.month-1,j.day,i[0],i[1]);return{year:h[0],month:h[1],day:h[2],hour:i[0],minute:i[1],unix:f.getTime(),gDate:f}}return!1},this.convertToUnix=function(a,b,c){if(!a)return null;if("number"==typeof a)return a;if("string"==typeof a)a=this.parseString(a,c);else{if(!(a instanceof Date))return null;a={year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),minute:a.getMinutes()}}if(a.year<=99&&(a.year="jalali"==b?1300+a.year:2e3+a.year),"jalali"==b){var d=this.validateJalaliDate(a,c);return d.unix||null}if("gregorian"==b){var d=new Date(this.toRegularFormat(a,b));return"Invalid Date"==d?null:d.getTime()}return null},this.convertFromUnix=function(a,b){var c=new Date(a);return"jalali"==b?this.convertToJalali(c):"gregorian"==b?{year:c.getFullYear(),month:c.getMonth()+1,day:c.getDate(),unix:a}:void 0},this.convertToJalali=function(c){if(c instanceof Date){var d={year:c.getFullYear(),month:c.getMonth()+1,day:c.getDate(),unix:c.getTime()};c=d}if(c instanceof Object)return a.extend(b.toJalali(c.year,c.month,c.day),{unix:c.unix})},this.parseDisablePattern=function(a){var b=a.disabled,c=a.smartDisabling,d=a.calType,e=a.format,f=Array.apply(null,Array(7)).map(Number.prototype.valueOf,0),g=Array.apply(null,Array(31)).map(Number.prototype.valueOf,0),h={};if(b instanceof Array)for(var i=0,j=b.length;i<j;i++)if("number"==typeof b[i]){var k=new Date(b[i]);"Invalid Date"!=k&&(h[this.removeTime(k).getTime()]=!0)}else if("string"==typeof b[i])if(b[i]=b[i].toLowerCase(),b[i].indexOf("d")==-1&&b[i].indexOf("i")==-1){var l=this.convertToUnix(b[i],d,e);l&&(h[l]=!0)}else{var m=new RegExp("^[!]?(([0-9]?[0-9])?[d]([+][0-9][0-9]?)?)([&]([0-9]?[0-9])?[d]([+][0-9][0-9]?)?)*?$").test(b[i]),n=new RegExp("^[!]?([i]([+][0-9][0-9]?)?)([&][i]([+][0-9][0-9]?)?)*?$").test(b[i]);if(m||n){var o="!"==b[i][0];b[i]=o?b[i].split("!")[1]:b[i];var p=b[i].split("&");if(m){var q={};p.forEach(function(a){var b=a.split(/d[+]?/).map(function(a){return Number(a)});b[0]=b[0]?b[0]:1,b[1]%=31;for(var c=0;c<31;c++)(1!=b[0]&&c%b[0]==b[1]||1==b[0]&&c==b[1])&&(q[c]=1)});for(var r=0;r<31;r++)o?q[r]||(g[r]=1):q[r]&&(g[r]=1)}else if(n){var q={};p.forEach(function(a){var b=a.split(/i[+]?/).map(function(a){return Number(a)});b[1]%=7,q[b[1]]=1});for(var r=0;r<7;r++)o?q[r]||(f[r]=1):q[r]&&(f[r]=1)}}else console.warn(b[i]+" is not valid!")}return{smart:c,calType:d,"static":h,inWeek:f,inMonth:g}},this.isDayDisable=function(a,b,c){if(b["static"][c.unix])return!0;var d=0;b.smart?"gregorian"==b.calType&&"jalali"==a?d=1:"jalali"==b.calType&&"gregorian"==a&&(d=-1):"gregorian"==b.calType&&"jalali"==a?d=-1:"jalali"==b.calType&&"gregorian"==a&&(d=1);var e=(c.dayName+7+d)%7;return!!b.inMonth[c.day-1]||!!+b.inWeek[e]},{dateFormat:this.dateFormat,parseString:this.parseString,toRegularFormat:this.toRegularFormat,isDateEqual:this.isDateEqual,isDateBigger:this.isDateBigger,isMonthBigger:this.isMonthBigger,joinTime:this.joinTime,removeTime:this.removeTime,validateJalaliDateSeparate:this.validateJalaliDateSeparate,validateJalaliDate:this.validateJalaliDate,convertToUnix:this.convertToUnix,convertFromUnix:this.convertFromUnix,convertToJalali:this.convertToJalali,parseDisablePattern:this.parseDisablePattern,isDayDisable:this.isDayDisable}},f=function(b,c,d,e,f){return{restrict:"E",replace:!0,require:"^^admDtp",link:function(b,g,h,i){var j;j=b.dtpValue?new Date(b.dtpValue.fullDate):new Date,"jalali"==b.calType&&(j=d.convertToJalali(j)),i.fillDays(j,!b.option.transition),b.previousMonth=function(a){return"jalali"!=b.calType||a?(1==b.current.month?(b.current.month=12,b.current.year--):b.current.month--,void i.reload()):void b.nextMonth(!0)},b.nextMonth=function(a){return"jalali"!=b.calType||a?(12==b.current.month?(b.current.month=1,b.current.year++):b.current.month++,void i.reload()):void b.previousMonth(!0)},b.previousYear=function(a){if("jalali"==b.calType&&!a)return void b.nextYear(!0);var c=b.generatedYears.shift();b.generatedYears=[];for(var d=1;d<17;d++)b.generatedYears.push(c-17+d)},b.nextYear=function(a){if("jalali"==b.calType&&!a)return void b.previousYear(!0);var c=b.generatedYears.pop();b.generatedYears=[];for(var d=1;d<17;d++)b.generatedYears.push(c+d)},b.selectMonthInit=function(){b.yearSelectStat=!1,b.monthPickerStat=!0},b.selectYearInit=function(){b.yearSelectStat=!0,b.generatedYears=[];for(var a=0;a<16;a++)b.generatedYears.push(b.current.year+a-7)},b.selectMonth=function(a){a+1!=b.current.month&&(b.current.month=a+1,i.reload()),b.monthPickerStat=!1},b.selectYear=function(a){a!=b.current.year&&(b.current.year=a,i.reload()),b.monthPickerStat=!1},b.selectThisDay=function(a){if(0!=a.valid)return b.dtpValue&&(b.dtpValue.selected=!1),i.updateMasterValue(a,"day"),b.option.autoClose?void f(function(){b.closeCalendar()},100):void(a.disable?f(function(){d.isMonthBigger(a,b.current)?b.nextMonth(!0):b.previousMonth(!0)},0):a.selected=!0)},b.today=function(){var a=new Date;"jalali"==b.calType&&(a=d.convertToJalali(a)),i.fillDays(a,!b.option.transition)},b.changeTimeValue=function(c,e){var f=(Number(b.time[c])+e+("hour"==c?24:60))%("hour"==c?24:60),g=a.copy(b.time);if(g[c]=f.lZero(),b.dtpValue&&(b.minDate||b.maxDate)){var h=d.joinTime(b.dtpValue.unix,g);if(b.minDate&&!d.isDateBigger(h,b.minDate)||b.maxDate&&!d.isDateBigger(b.maxDate,h))return}b.time[c]=f.lZero(),b.dtpValue&&i.updateMasterValue(!1,"time"),i.reload()},b.modelChanged=function(a){if(b.dtpValue){var c=a||b.dtpValue.formated;if(!c)return void b.destroy();var e=d.convertToUnix(c,b.calType,b.option.format);if(!e||b.minDate&&!d.isDateBigger(e,b.minDate)||b.maxDate&&!d.isDateBigger(b.maxDate,e))return void i.updateMasterValue(!1);if(e!=b.fullData.unix){b.parseInputValue(c,!1,!0);var f=new Date(e);"jalali"==b.calType&&(f=d.convertToJalali(f)),i.fillDays(f,!0)}}},b.calTypeChanged=function(){b.calType="gregorian"==b.calType?"jalali":"gregorian",b.monthNames=e.calendars[b.calType].monthsNames,b.daysNames=e.calendars[b.calType].daysNames;var f,g=a.copy(b.current);"jalali"==b.calType?f=c.toJalali(g.year,g.month,15):(f=c.toGregorian(g.year,g.month,15),f=new Date(f.year,f.month-1,f.day)),b.dtpValue&&i.updateMasterValue(d.convertFromUnix(b.dtpValue.unix,b.calType)),i.fillDays(f,!0)}},template:'<div class="ADMdtp-calendar-container" ng-class="{square: monthPickerStat||timePickerStat}"><div class="monthPickerContainer" ng-class="{active: monthPickerStat}"><i class="calendarIcon" ng-class="{show: monthPickerStat}" ng-click="monthPickerStat = false"><svg viewBox="0 0 1664 1664"><use xlink:href="#dtpCalendar" /></svg></i><div class="content">            <div class="monthContainer" ng-class="{onYear: yearSelectStat, rtl: (calType==\'jalali\')}"><div class="yearContainer"><span ng-if="yearSelectStat" class="dtpIcon arrow left" ng-click="previousYear()"></span><p ng-click="selectYearInit()">{{current.year | digitType:calType}}</p><span ng-if="yearSelectStat" class="dtpIcon arrow right" ng-click="nextYear()"></span></div><span ng-repeat="yearName in generatedYears" ng-if="yearSelectStat"><span ng-class="{selected: yearName==current.year}" ng-click="selectYear(yearName)">{{yearName | digitType:calType}}</span></span><span ng-repeat="monthName in monthNames" ng-if="!yearSelectStat"><span ng-class="{selected: monthName==current.monthDscr}" ng-click="selectMonth($index)">{{monthName}}</span></span></div></div></div><div class="timePickerContainer" ng-class="{active: timePickerStat}"><i class="calendarIcon" ng-class="{show: timePickerStat}" ng-click="timePickerStat = false"><svg viewBox="0 0 1664 1664"><use xlink:href="#dtpCalendar" /></svg></i><div class="content"><div class="timePicker"><span class="dtpIcon null up" ng-click="changeTimeValue(\'hour\', 1)"><svg viewBox="0 0 1792 1792"><use xlink:href="#dtpDown" /></svg></span><!----><span></span><!----><span class="dtpIcon null up" ng-click="changeTimeValue(\'minute\', 1)"><svg viewBox="0 0 1792 1792"><use xlink:href="#dtpDown" /></svg></span><!----><span>{{time.hour}}</span><!----><span class="period">:</span><!----><span>{{time.minute}}</span><!----><span class="dtpIcon null down" ng-click="changeTimeValue(\'hour\', -1)"><svg viewBox="0 0 1792 1792"><use xlink:href="#dtpUp" /></svg></span><!----><span></span><!----><span class="dtpIcon null down" ng-click="changeTimeValue(\'minute\', -1)"><svg viewBox="0 0 1792 1792"><use xlink:href="#dtpUp" /></svg></span></div></div></div><header><span class="dtpIcon arrow left" ng-click="previousMonth()"></span><span class="yearMonth" ng-click="selectMonthInit()">{{current.monthDscr}} {{current.year | digitType:calType}}</span><span class="dtpIcon arrow right" ng-click="nextMonth()"></span></header><div class="daysNames"><span ng-repeat="dayName in daysNames">{{dayName}}</span></div><hr><div class="days" ng-class="{loading:loadingDays}"><span ng-repeat="day in current.days" ng-click="selectThisDay(day)"><span ng-class="[{disable: day.disable||!day.valid, today: day.today, selected: day.selected, valid:(day.valid==2)}, (day.isMin)?((calType==\'jalali\')?\'max\':\'min\'):\'\', (day.isMax)?((calType==\'jalali\')?\'min\':\'max\'):\'\']">{{day.day | digitType:calType}}</span></span></div><hr><footer><div class="calTypeContainer" ng-class="$parent.calType" ng-click="calTypeChanged()"  ng-if="option.multiple"><p class="gregorian">Gregorian</p><p class="jalali">جلالی</p></div><button type="button" class="today" ng-click="today()">{{(calType=="jalali")?"امروز":"Today"}}</button><svg class="timeSelectIcon" viewBox="0 0 1492 1592" ng-click="timePickerStat = !timePickerStat"><use xlink:href="#dtpClock" /></svg></footer></div>'}},g=function(b,c,d,e,f,g){return{restrict:"E",replace:!0,transclude:!0,require:"ngModel",scope:{options:"=?",fullData:"=?",onChange:"&",onDatechange:"&",onTimechange:"&",onOpen:"&",onClose:"&"},link:function(c,h,i,j){h.find("ng-transclude").children().length||(c.defaultTemplate=!0,h.find("ng-transclude").remove());var k=c.options;k instanceof Object||(k={}),c.option=a.extend(a.copy(b.getOptions()),k),c.disableDays=d.parseDisablePattern(c.option),c.calType=c.option.calType,c.monthNames=e.calendars[c.calType].monthsNames,c.daysNames=e.calendars[c.calType].daysNames,c.timeoutValue=[0,0],c.minDate=c.mindate?new Date(c.mindate):null,c.maxDate=c.maxdate?new Date(c.maxdate):null,c.current={year:"",month:"",monthDscr:"",days:[]},c.updateMasterValue=function(a,b){a||(a=c.dtpValue),c.$applyAsync(function(){c.dtpValue=a,c.dtpValue.formated=d.dateFormat(a,c.time,c.option.format),c.dtpValue.fullDate=d.joinTime(a.unix,c.time),c.fullData={formated:c.dtpValue.formated,gDate:c.dtpValue.fullDate,unix:c.dtpValue.fullDate.getTime(),year:a.year,month:a.month,day:a.day,hour:Number(c.time.hour),minute:Number(c.time.minute),minDate:c.minDate,maxDate:c.maxDate,calType:c.calType,format:c.option.format},j.$setViewValue(c.dtpValue.formated),j.$render(),l.value&&(l.value=c.dtpValue.formated),b&&(c.onChange&&c.onChange({date:c.fullData}),"time"==b&&c.onTimechange?c.onTimechange({date:c.fullData}):"day"==b&&c.onDatechange&&c.onDatechange({date:c.fullData}))})},c.parseInputValue=function(a,b,e){"today"==a&&(a=d.removeTime(new Date).getTime());var f=!1;a&&("jalali"==c.calType?f=d.validateJalaliDate(a,c.option.format):("string"==typeof a&&(a=d.toRegularFormat(a,c.calType,c.option.format)),f=new Date(a),f="Invalid Date"!=f&&f)),f?(c.dtpValue={year:f.year||f.getFullYear(),month:f.month||f.getMonth()+1,day:f.day||f.getDate(),unix:f.unix||f.getTime(),fullDate:f.gDate||f},c.dtpValue.fullDate=d.removeTime(c.dtpValue.fullDate),c.dtpValue.unix=c.dtpValue.fullDate.getTime(),c.time={hour:(f.getHours?f.getHours():f.hour).lZero(),minute:(f.getMinutes?f.getMinutes():f.minute).lZero()},c.updateMasterValue(!1,e)):b&&(c.time={hour:"00",minute:"00"})},c.parseInputValue(j.$viewValue||c.option["default"],!0,!1),j.$formatters.push(function(a){if(a){if(c.dtpValue&&a==c.dtpValue.formated)return;c.parseInputValue(a,!1,!0)}else c.destroy();return a}),i.$observe("disable",function(a){c.$applyAsync(function(){a=c.$eval(a),c.disable=a})}),i.$observe("mindate",function(a){c.$applyAsync(function(){a=c.$eval(a),c.minDate=d.convertToUnix(a,c.calType,c.option.format)})}),i.$observe("maxdate",function(a){c.$applyAsync(function(){a=c.$eval(a),c.maxDate=d.convertToUnix(a,c.calType,c.option.format)})}),c.openCalendar=function(){if(!c.showCalendarStat&&!c.disable){c.timeoutValue[0]=0,c.showCalendarStat=!0;var b=a.element('<adm-dtp-calendar style="opacity:0;"></adm-dtp-calendar>');a.element(h.children()[0]).append(b),c.$applyAsync(function(){f(b)(c)}),g(function(){var b=a.element(h.children()[0]).children()[1],c=b.getBoundingClientRect(),d=h.children().children()[0],e=d.getBoundingClientRect(),f={x:e.left,y:e.top+e.height},g={width:c.width+f.x,height:c.height+f.y},i={top:"",bottom:"",left:"",right:""};g.height>window.innerHeight?i.bottom=e.height+"px":i.top=e.height+"px",g.width>window.innerWidth?i.left=window.innerWidth-g.width-20+"px":i.left=0,a.element(b).css({top:i.top,bottom:i.bottom,left:i.left,opacity:1})},70),c.onOpen&&c.onOpen()}},c.closeCalendar=function(){c.showCalendarStat&&(c.$applyAsync(function(){c.monthPickerStat=!1,c.timePickerStat=!1,c.showCalendarStat=!1}),a.element(h.children()[0]).children()[1]&&(a.element(a.element(h.children()[0]).children()[1]).remove(),c.onClose&&c.onClose()))},c.toggleCalendar=function(){c.showCalendarStat?c.closeCalendar():c.openCalendar()},c.destroy=function(){if(!c.disable){c.monthPickerStat=!1,c.timePickerStat=!1,c.current={year:"",month:"",monthDscr:"",days:[]},c.dtpValue=!1,c.fullData={minDate:c.minDate,maxDate:c.maxDate},c.time={hour:"00",minute:"00"};var a=new Date;"jalali"==c.calType&&(a=d.convertToJalali(a)),j.$setViewValue(""),j.$render(),c.fillDays(a,!c.option.transition),c.onChange&&c.onChange({date:c.fullData})}};var l=h[0].querySelector("[dtp-input]")||{};l.onblur=function(){c.modelChanged(this.value)},l.onfocus=c.openCalendar;var m=h[0].querySelector("[dtp-open]")||{};m.onclick=c.openCalendar;var n=h[0].querySelector("[dtp-close]")||{};n.onclick=c.closeCalendar;var o=h[0].querySelector("[dtp-toggle]")||{};o.onclick=c.toggleCalendar;var p=h[0].querySelector("[dtp-destroy]")||{};p.onclick=c.destroy},controller:["$scope",function(b){this.updateMasterValue=function(a,c){b.updateMasterValue(a,c)},this.fillDays=function(e,f){f?b.timeoutValue[0]=0:b.loadingDays=!0;var h=a.copy(e);if("jalali"==b.calType){var i=c.toGregorian(e.year,e.month,29);e=new Date(i.year,i.month-1,i.day)}var j={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()};b.$applyAsync(function(){var c=h.month||h.getMonth()+1;a.extend(b.current,{year:h.year||h.getFullYear(),month:c,monthDscr:b.monthNames[c-1]})});var k=new Date;k=new Date(k.getFullYear(),k.getMonth(),k.getDate()).getTime();var l,m=-1;b.dtpValue&&(m=b.dtpValue.unix);var n,o=new Date(j.year,j.month-1,j.day),p=new Date(a.copy(o).setDate(1)).getDay(),q=[],r=-1*p,s=!0,t=-1;if("jalali"==b.calType){var n=new Date(a.copy(o).setDate(r)),u=c.toJalali(n.getFullYear(),n.getMonth()+1,n.getDate());r-=7*Math.ceil((u.day-1)/7)+1}for(;;){r++;var n=new Date(a.copy(o).setDate(r)),u=!1;"jalali"==b.calType&&(u=c.toJalali(n.getFullYear(),n.getMonth()+1,n.getDate()));var v=u.day||n.getDate();if(1==v&&(s=!s),s&&v<8&&("jalali"==b.calType&&6==n.getDay()||"gregorian"==b.calType&&0==n.getDay()))break;var w=!1,x=1;if(b.minDate||b.maxDate){var y=d.joinTime(n,b.time);b.minDate&&!d.isDateBigger(y,b.minDate)||b.maxDate&&!d.isDateBigger(b.maxDate,y)?(x=0,2==t&&(q[q.length-1].isMax=!0)):(x=2,0==t&&(w=!0)),t=x}var z=n.getTime(),A=n.getDay()+("jalali"==b.calType?1:0),B={day:v,month:u.month||n.getMonth()+1,year:u.year||n.getFullYear(),dayName:A,fullDate:n,disable:s,today:z==k,selected:z==m,unix:z,valid:x,isMin:w};d.isDayDisable(b.calType,b.disableDays,B)&&(B.valid=0),B.selected&&(l=q.length),q.push(B)}g(function(){b.timeoutValue[0]=500,b.$applyAsync(function(){b.current.days=q,l&&b.updateMasterValue(b.current.days[l]),g(function(){b.loadingDays=!1},b.timeoutValue[1])})},b.timeoutValue[0])},this.reload=function(){var c=a.copy(b.current);c.day=29;var d=new Date(c.year,c.month-1,8);"jalali"==b.calType&&(d=c),this.fillDays(d,!b.option.transition)},b.fillDays=this.fillDays}],template:'<div class="ADMdtp-container" ng-class="{rtl: (calType==\'jalali\'), touch: option.isDeviceTouch, disable: disable}"><div class="clickOutContainer" click-out="closeCalendar()"><ng-transclude></ng-transclude> <div ng-if="defaultTemplate" class="masterInput" ng-class="{touch: option.isDeviceTouch, disable: disable, open: showCalendarStat}"><input type="text" ng-model="dtpValue.formated" ng-focus="openCalendar()" ng-disabled="option.freezeInput || option.isDeviceTouch || disable" ng-blur="modelChanged()"><div class="iconContainer" ng-click="toggleCalendar()"><i class="dtpIcon null fakeIcon"></i><svg class="calendarIcon" viewBox="0 0 1664 1664"><use xlink:href="#dtpCalendar" /></svg><svg class="closeIcon" viewBox="0 0 1400 1400"><use xlink:href="#dtpOff" /></svg></div><svg class="removeIcon" viewBox="0 0 1408 1408" ng-if="dtpValue.formated" ng-click="destroy()"><use stroke-width="20" xlink:href="#dtpTimes" /></svg></div></div><svg style="display:none;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"><defs><path id="dtpCalendar" d="M128 -128h288v288h-288v-288zM480 -128h320v288h-320v-288zM128 224h288v320h-288v-320zM480 224h320v320h-320v-320zM128 608h288v288h-288v-288zM864 -128h320v288h-320v-288zM480 608h320v288h-320v-288zM1248 -128h288v288h-288v-288zM864 224h320v320h-320v-320z M512 1088v288q0 13 -9.5 22.5t-22.5 9.5h-64q-13 0 -22.5 -9.5t-9.5 -22.5v-288q0 -13 9.5 -22.5t22.5 -9.5h64q13 0 22.5 9.5t9.5 22.5zM1248 224h288v320h-288v-320zM864 608h320v288h-320v-288zM1248 608h288v288h-288v-288zM1280 1088v288q0 13 -9.5 22.5t-22.5 9.5h-64 q-13 0 -22.5 -9.5t-9.5 -22.5v-288q0 -13 9.5 -22.5t22.5 -9.5h64q13 0 22.5 9.5t9.5 22.5zM1664 1152v-1280q0 -52 -38 -90t-90 -38h-1408q-52 0 -90 38t-38 90v1280q0 52 38 90t90 38h128v96q0 66 47 113t113 47h64q66 0 113 -47t47 -113v-96h384v96q0 66 47 113t113 47 h64q66 0 113 -47t47 -113v-96h128q52 0 90 -38t38 -90z" /><path id="dtpOff" d="M1536 640q0 -156 -61 -298t-164 -245t-245 -164t-298 -61t-298 61t-245 164t-164 245t-61 298q0 182 80.5 343t226.5 270q43 32 95.5 25t83.5 -50q32 -42 24.5 -94.5t-49.5 -84.5q-98 -74 -151.5 -181t-53.5 -228q0 -104 40.5 -198.5t109.5 -163.5t163.5 -109.5 t198.5 -40.5t198.5 40.5t163.5 109.5t109.5 163.5t40.5 198.5q0 121 -53.5 228t-151.5 181q-42 32 -49.5 84.5t24.5 94.5q31 43 84 50t95 -25q146 -109 226.5 -270t80.5 -343zM896 1408v-640q0 -52 -38 -90t-90 -38t-90 38t-38 90v640q0 52 38 90t90 38t90 -38t38 -90z" /><path id="dtpClock" d="M896 992v-448q0 -14 -9 -23t-23 -9h-320q-14 0 -23 9t-9 23v64q0 14 9 23t23 9h224v352q0 14 9 23t23 9h64q14 0 23 -9t9 -23zM1312 640q0 148 -73 273t-198 198t-273 73t-273 -73t-198 -198t-73 -273t73 -273t198 -198t273 -73t273 73t198 198t73 273zM1536 640 q0 -209 -103 -385.5t-279.5 -279.5t-385.5 -103t-385.5 103t-279.5 279.5t-103 385.5t103 385.5t279.5 279.5t385.5 103t385.5 -103t279.5 -279.5t103 -385.5z" /><path id="dtpTimes" horiz-adv-x="1408" d="M1298 214q0 -40 -28 -68l-136 -136q-28 -28 -68 -28t-68 28l-294 294l-294 -294q-28 -28 -68 -28t-68 28l-136 136q-28 28 -28 68t28 68l294 294l-294 294q-28 28 -28 68t28 68l136 136q28 28 68 28t68 -28l294 -294l294 294q28 28 68 28t68 -28l136 -136q28 -28 28 -68 t-28 -68l-294 -294l294 -294q28 -28 28 -68z" /><path id="dtpUp" horiz-adv-x="1792" d="M1683 205l-166 -165q-19 -19 -45 -19t-45 19l-531 531l-531 -531q-19 -19 -45 -19t-45 19l-166 165q-19 19 -19 45.5t19 45.5l742 741q19 19 45 19t45 -19l742 -741q19 -19 19 -45.5t-19 -45.5z" /><path id="dtpDown" horiz-adv-x="1792" d="M1683 728l-742 -741q-19 -19 -45 -19t-45 19l-742 741q-19 19 -19 45.5t19 45.5l166 165q19 19 45 19t45 -19l531 -531l531 531q19 19 45 19t45 -19l166 -165q19 -19 19 -45.5t-19 -45.5z" /></defs></svg> </div>'}},h=function(a){return{restrict:"A",scope:{clickOut:"&"},link:function(b,c,d){var e=void 0!==d.outsideIfNot?d.outsideIfNot.replace(", ",",").split(","):[];void 0==d.id&&d.$set("id","id_"+Math.random()),void 0!==d.id&&e.push(d.id),a.on("click contextmenu",function(a){var c,d=0;if(a.target){for(c=a.target;c;c=c.parentNode){var f=c.id,g=c.className;if(void 0!==f)for(d=0;d<e.length;d++)if(f.indexOf(e[d])>-1||"string"==typeof g&&g.indexOf(e[d])>-1)return}b.$eval(b.clickOut)}})}}},i=function(a){try{document.createEvent("TouchEvent"),a.setOptions({isDeviceTouch:!0})}catch(b){a.setOptions({isDeviceTouch:!1})}};return a.module("ADM-dateTimePicker",[]).constant("constants",{calendars:{gregorian:{monthsNames:["January","February","March","April","May","June","July","August","September","October","November","December"],daysNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},jalali:{monthsNames:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],daysNames:["ش","ی","د","س","چ","پ","ج"]}}}).provider("ADMdtp",b).filter("digitType",[c]).factory("ADMdtpConvertor",[d]).factory("ADMdtpFactory",["ADMdtpConvertor",e]).directive("admDtp",["ADMdtp","ADMdtpConvertor","ADMdtpFactory","constants","$compile","$timeout",g]).directive("admDtpCalendar",["ADMdtp","ADMdtpConvertor","ADMdtpFactory","constants","$timeout",f]).directive("clickOut",["$document",h]).config(["ADMdtpProvider",i])}(window.angular);